from scapy.all import *

# 定义网卡接口
interface = "eth0"  # 替换为你的网卡接口

# 构造以太网帧
ether = Ether(
    dst="01:80:c2:00:00:21",  # GVRP 多播地址
    src="00:11:22:33:44:55"   # 替换为你的网卡 MAC 地址
)

# 构造 802.1Q VLAN 标签（VLAN ID = 10）
vlan = Dot1Q(vlan=10)

# 构造 GVRP JoinEmpty 消息
gvrp = Raw(load=bytes.fromhex(
    "01" +      # 协议 ID (0x0001 for GVRP)
    "02" +      # 消息类型：JoinEmpty (0x02)
    "01" +      # 属性类型：VLAN (0x01)
    "03" +      # 属性长度：3 字节
    "000a" +    # VLAN ID：10 (0x000a)
    "00"        # 结束标记
))

# 组合数据包
packet = ether / vlan / gvrp

# 显示数据包结构
packet.show()

# 发送数据包
sendp(packet, iface=interface, verbose=True)